<!DOCTYPE html>
<html lang="en">
<head>
    <title>Spring Boot Api Cloud Gateway Implementation - StackSaga</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Spring Boot Api Cloud Gateway Implementation - StackSaga">
    <meta name="author" content="Mafei">


    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="180x180" href="./../../../../../assets/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./../../../../../assets/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./../../../../../assets/fav/favicon-16x16.png">
    <link rel="manifest" href="./../../../../../assets/fav/site.webmanifest">
    <link rel="mask-icon" href="./../../../../../assets/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="apple-mobile-web-app-title" content="Spring Boot Api Cloud Gateway Implementation - StackSaga">
    <meta name="application-name" content="stacksaga">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#28b76b">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700&display=swap" rel="stylesheet">

    <!-- FontAwesome JS-->
    <script defer src="../../../../../assets/fontawesome/js/all.min.js"></script>

    <!-- Plugins CSS -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.2/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../../assets/plugins/simplelightbox/simple-lightbox.min.css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="../../../../../assets/css/theme.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LC0M1Q19EK"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-LC0M1Q19EK');
    </script>
    <link rel="stylesheet" href="../../../../../assets/css/custom.css">


</head>

<body class="docs-page">
<header class="header fixed-top">
    <div class="branding docs-branding">
        <div class="container-fluid position-relative py-2">
            <div class="docs-logo-wrapper">
                <!--<button id="docs-sidebar-toggler" class="docs-sidebar-toggler docs-sidebar-visible me-2 d-xl-none"
                        type="button">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>-->
                <div class="site-logo">
                    <a class="navbar-brand" href="../../../../../index.html">
                        <img width="8%" height="8%" src="../../../../../assets/images/stack-saga-icon.svg"
                             alt="logo"/>
                        <span class="logo-text">Stack<span class="text-alt">SAGA</span></span>
                    </a>
                </div>

            </div><!--//docs-logo-wrapper-->
            <div class="docs-top-utilities d-flex justify-content-end align-items-center">
                <div class="top-search-box d-none d-lg-flex">
                    <!--<form class="search-form">
                        <input type="text" placeholder="Search the docs..." name="search"
                               class="form-control search-input"/>
                        <button type="submit" class="btn search-btn" value="Search"><i class="fas fa-search"></i>
                        </button>
                    </form>-->
                    <form class="search-form search-input">
                        <div class="form-group">
                            <select class="form-control" id="exampleFormControlSelect1">
                                <option selected>version 1.0.0</option>
                            </select>
                        </div>
                    </form>


                </div>

                <ul class="social-list list-inline mx-md-3 mx-lg-5 mb-0 d-none d-lg-flex">
                    <li class="list-inline-item"><a href="https://github.com/stacksaga"><i
                            class="fab fa-github fa-fw"></i></a></li>
                    <li class="list-inline-item"><a href="https://stackoverflow.com/questions/tagged/stacksaga"><i
                            class="fab fa-stack-overflow fa-fw"></i></a></li>

                </ul><!--//social-list-->

            </div><!--//docs-top-utilities-->
        </div><!--//container-->
    </div><!--//branding-->
</header><!--//header-->


<div class="docs-wrapper">
    <div id="docs-sidebar" class="docs-sidebar">
        <div class="top-search-box d-lg-none p-3">
            <form class="search-form">
                <input type="text" placeholder="Search the docs..." name="search" class="form-control search-input">
                <button type="submit" class="btn search-btn" value="Search"><i class="fas fa-search"></i></button>
            </form>
        </div>
        <nav id="docs-nav" class="docs-nav navbar">
            <ul class="section-items list-unstyled nav flex-column pb-3">
                <li class="nav-item section-title"><a class="nav-link scrollto active" href="#section-1"><span
                        class="theme-icon-holder me-2"><i class="fas fa-map-signs"></i></span>API Gateway</a></li>
                <li class="nav-item"><a class="nav-link scrollto" href="#Introduction">Introduction</a></li>
                <li class="nav-item"><a class="nav-link scrollto" href="#Creating">Creating</a></li>
                <li class="nav-item"><a class="nav-link scrollto" href="#Implementation">Implementation</a></li>
            </ul>

        </nav><!--//docs-nav-->
    </div><!--//docs-sidebar-->
    <div class="docs-content">
        <div class="container">
            <article class="docs-article" id="section-1">
                <header class="docs-header">
                    <div class="text-center" style="padding-bottom: 10px">
                        <div class="btn-group" role="group" aria-label="Basic example">
                            <a href="#" class="btn btn-primary">Imperative Way</a>
                            <a href="#" class="btn btn-light">Reactive Way</a>

                        </div>
                    </div>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb" style="padding-left: 0 !important;">
                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                            <li class="breadcrumb-item"><a href="#">Imperative</a></li>
                            <li class="breadcrumb-item"><a href="#">Mysql</a></li>
                            <li class="breadcrumb-item active" aria-current="page">1.0</li>
                        </ol>
                    </nav>
                    <h1 id="Introduction" class="docs-heading">Introduction</h1>
                    <section class="docs-intro">
                        <p>
                            In the <a href="example-eureka-service-implementation.html">previous articles</a>, we have
                            successfully created the eureka-server,
                            As the next step we are going to implement the spring api cloud gateway. An API gateway is
                            programming that sits in front of an API ( Application Programming
                            Interface) and is the single-entry point for defined back-end APIs and microservices (which
                            can be both internal and external). Sitting in front of APIs, the gateway acts as
                            protection, administering security and scalability, and high availability. To put it simply,
                            API Gateway takes all API requests from a customer, determines which services are demanded,
                            and combines them into a unified, flawless experience for users.
                        </p>
                        <br>
                        <b>Advantages of API Gateway</b>
                        <ul>
                            <li>
                                It improves the security of the microservices as we limit the access of external calls
                                to all our services.
                            </li>

                            <li>
                                The cross-cutting concerns like authentication, monitoring/metrics, and resiliency will
                                be needed to be implemented only in the API Gateway as all our calls will be routed
                                through it.
                            </li>


                            <li>
                                The client does not know about the internal architecture of our microservices system.
                                The client will not be able to determine the location of the microservice instances.
                            </li>

                            <li>
                                Simplifies client interaction as he will need to access only a single service for all
                                the requirements.
                            </li>

                        </ul>
                        <a href="https://github.com/stacksaga/stacksaga-implementation-example/tree/without-StackSaga"
                           target="_blank">
                            Full source code on GitHub (Without StackSaga)
                        </a>
                        <br>
                        <br>
                        <img class="img-fluid"
                             src="../../../../../assets/img/mysql/1.0/imperative/stack-saga-e-store-example-api-gateway-with-eureka-server.drawio.svg"
                             alt="stacksaga e-store example creating api-gateway-service"/>
                        <br>
                        <br>


                        <h3 class="section-heading">Usage Of Api-Gateway With StackSaga</h3>
                        <p>
                            To communicate individual services with the admin, StackSaga Connect should be used and
                            therefore, to protect the <code>/stacksaga</code> endpoints, StackSaga shield also should be
                            used.
                            to use the StackSaga shield with the api gateway, we have to create a
                            <code>ROLE_GATEWAY</code> user and get the credentials. let's go to the StackSaga Admin
                            dashboard and create a new user for a new api-gateway step by step.
                            <br>
                            Read <a href="./../../../architecture.html#key-process-of-stacksaga" target="_blank">StackSaga
                            architecture in high level</a>
                            page to get the idea how behave the ecosystem.
                        </p>


                        <br>
                        <p><b>1.</b> Go to the <b>users</b> page and select the <b>Registration</b> tab to register the
                            new api
                            gateway user.</p>
                        <img class="img-fluid"
                             src="../../../../../assets/images/architecture/1.0/create-ROLE-GATEWAY-step-1.png"
                             alt="create gateway user step-1"/>

                        <br>
                        <br>
                        <p><b>2.</b> Before adding the gateway user, we have to create a new api-gateway (because in the
                            StackSaga system, one api-gateway-can have multiple gateway-users.)</p>
                        <img class="img-fluid"
                             src="../../../../../assets/images/architecture/1.0/create-ROLE-GATEWAY-step-2.png"
                             alt="create gateway user step-2"/>

                        <br>
                        <br>
                        <p><b>3.</b> After entering the user data, you will have a generated password by the StackSaga
                            admin. Save the username and the password in a secret file. it is the credential that we
                            want use for the shield congregation properties.</p>
                        <img class="img-fluid"
                             src="../../../../../assets/images/architecture/1.0/create-ROLE-GATEWAY-step-3.png"
                             alt="create gateway user step-2"/>

                        <br>
                        <br>

                        <p><b>4.</b> you can see the new user in the list.</p>
                        <img class="img-fluid"
                             src="../../../../../assets/images/architecture/1.0/create-ROLE-GATEWAY-step-4.png"
                             alt="create gateway user step-2"/>

                        <br>


                        <br>


                        <h3 id="Creating" class="section-heading">Creating api-gateway-service.</h3>
                        <p>
                            Visit to the spring initializer and create the project by adding the following dependencies.
                        </p>
                        <img class="img-fluid"
                             src="../../../../../assets/img/mysql/1.0/imperative/api-gateway-implementation/stack-saga-example-cloud-api-gateway-creating.jpeg"
                             alt="stacksaga e-store example creating api-gateway-service"/>
                        <br>
                        <br>
                        <h4 id="Implementation">Implementation of api-gateway-service</h4>
                        <br>
                        <p>
                            the next step is adding the <a
                                href="./../../../reference/stacksaga-framework.html#stacksaga-shield" target="_blank">StackSaga
                            Shield</a> in to the api-gateway service. to add the maven plugin in to the project, copy
                            this code and enter it into the <code>pom.xml</code>'s <code>dependencies</code> section.
                        </p>
                        <script src="https://gist.github.com/mafei-dev/e21ae3ec56fb77d5ecf053c7bf773704.js"></script>

                        <br>
                        <h5>
                            Configuration properties
                        </h5>
                        <p>
                            To connect with eureka server and other utility microservices, We have to put some
                            properties and configurations by default in the spring framework.
                            in addition to that, StackSaga Shield also has more <a href="./../../../configurations/configuration-properties-of-stackSaga-starter-shield.html" target="_blank">configurations</a> to be added.
                            in the <code>application.yml</code>
                            file.
                        </p>
                        <h6>application.yml</h6>
                        <small>
                            <b>api-gateway >
                                src/main/resources/application.yml
                            </b>
                        </small>
                        <script src="https://gist.github.com/mafei-dev/4d95ac121d0e523e99441e074daf3470.js"></script>
                        <br>
                        <br>
                        <h5>
                            Annotate the main class
                        </h5>

                        <p>in the api-gateway project, we have to use two annotations for enabling the eureka client
                            capabilities <code>@EnableEurekaClient</code> and enabling the webflux capabilities <code>@EnableWebFlux</code>.
                            (Api-gateway uses internally reactive way with webflux to increase the performance and to
                            the
                            resilience of the application due to all the requests are going through the Api-gateway for
                            each service )
                        </p>
                        <small>
                            <b>api-gateway >
                                org/mono/stacksaga/example/apigateway/ApiGatewayApplication.java
                            </b>
                        </small>
                        <script src="https://gist.github.com/mafei-dev/31a494c930f9554960f9825191d3345a.js"></script>
                        <br>
                        <br>
                        <p>Now the api-gateway is ready to use.</p>
                        <img class="img-fluid"
                             src="../../../../../assets/img/mysql/1.0/imperative/api-gateway-implementation/stacksaga-example-api-gateway-health-check.png"
                             alt="stacksaga e-store example  api-gateway health check"/>
                        <br>
                        <p>Check the health by using the Curl.</p>

                        <code>
                            curl --location --request GET 'http://localhost:8080/actuator/health'
                        </code>
                        <br>
                        <br>

                        <p>
                            <b>After all, The api-gateway project folder and file structure like below.</b></p>

                        <pre>
└───main
    ├───java
    │   └───org
    │       └───mono
    │           └───stacksaga
    │               └───example
    │                   └───apigateway
    │                           ApiGatewayApplication.java
    │
    └───resources
            application.yml

                        </pre>
                    </section><!--//docs-intro-->

                </header>


                <div>
                    Previous <a href="example-eureka-service-implementation.html">Implementation of eureka server</a>
                    <br>
                    Next <a href="example-order-service-implementation.html">Implementation of order-service</a>
                </div>


                <section class="docs-section">
                    <h2>Example series</h2>
                    <ul>
                        <li>
                            <p>
                                Microservice example without using StackSAGA (Imperative way)
                            </p>
                            <ul>

                                <li>
                                    <p>
                                        <a href="./quick-start.html" target="_blank">
                                            Introduction
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./example-order-service-implementation.html" target="_blank">
                                            Implementation of order-service
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./example-user-service-implementation.html" target="_blank">
                                            Implementation of eureka server
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <a href="./api-cloud-gateway-implementation.html" target="_blank">
                                            Implementation of Api-gateway
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./example-user-service-implementation.html" target="_blank">
                                            Implementation of user-service
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./example-payment-service-implementation.html" target="_blank">
                                            Implementation of payment-service
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./example-delivery-service-implementation.html" target="_blank">
                                            Implementation of delivery-service
                                        </a>
                                    </p>
                                </li>


                                <li>
                                    <p>
                                        <a href="./microservice-example-test-without-stacksaga.html" target="_blank">
                                            Final application test without using StackSaga
                                        </a>
                                    </p>
                                </li>


                            </ul>
                        </li>

                        <li>
                            <p>
                                Microservice example by using StackSAGA (Imperative way).
                            </p>
                            <ul>

                                <li>
                                    <p>
                                        <a href="./using-stacksaga/stacksaga-spring-boot-microservice-example-with-stacksaga-user-service.html"
                                           target="_blank">
                                            user-service - migration to Saga design pattern
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./using-stacksaga/stacksaga-spring-boot-microservice-example-with-stacksaga-payment-service.html"
                                           target="_blank">
                                            payment-service - migration to Saga design pattern
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./using-stacksaga/stacksaga-spring-boot-microservice-example-with-stacksaga-delivery-service.html"
                                           target="_blank">
                                            delivery-service - migration to Saga design pattern
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./using-stacksaga/stacksaga-spring-boot-microservice-example-with-stacksaga-order-service.html"
                                           target="_blank">
                                            order-service - migration to Saga design pattern
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./using-stacksaga/stacksaga-spring-boot-microservice-example-with-stacksaga.html"
                                           target="_blank">
                                            order-service - migration to Saga design pattern with StackSaga
                                        </a>
                                    </p>
                                </li>

                                <li>
                                    <p>
                                        <a href="./using-stacksaga/stacksaga-spring-boot-microservice-example-test-with-stacksaga.html"
                                           target="_blank">
                                            Final application using StackSaga
                                        </a>
                                    </p>
                                </li>

                            </ul>
                        </li>

                    </ul>

                </section>

            </article>

        </div>
    </div>
</div><!--//docs-wrapper-->


<!-- Javascript -->
<script src="../../../../../assets/plugins/popper.min.js"></script>
<script src="../../../../../assets/plugins/bootstrap/js/bootstrap.min.js"></script>


<!-- Page Specific JS -->
<script src="../../../../../assets/plugins/smoothscroll.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
<script src="../../../../../assets/js/highlight-custom.js"></script>
<script src="../../../../../assets/plugins/simplelightbox/simple-lightbox.min.js"></script>
<script src="../../../../../assets/plugins/gumshoe/gumshoe.polyfills.min.js"></script>
<script src="../../../../../assets/js/docs.js"></script>


</body>
</html> 

