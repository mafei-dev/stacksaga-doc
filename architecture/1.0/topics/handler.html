<!DOCTYPE html>
<html lang="en">
<head>
    <title>Handler - StackSAGA</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Introduction to stacksaga">
    <meta name="author" content="Mafei">

    <link type="image/png" sizes="16x16" rel="stacksaga-icon" href="./../../../stacksaga-16.png">
    <link type="image/png" sizes="32x32" rel="stacksaga-icon" href="./../../../stacksaga-32.png">
    <link type="image/png" sizes="96x96" rel="stacksaga-icon" href="./../../../stacksaga-96.png">
    <meta name="stacksaga-TileColor" content="#da532c">
    <meta name="theme-color" content="#28b76b">


    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700&display=swap" rel="stylesheet">

    <!-- FontAwesome JS-->
    <script defer src="../../../assets/fontawesome/js/all.min.js"></script>

    <!-- Plugins CSS -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.2/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../assets/plugins/simplelightbox/simple-lightbox.min.css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="../../../assets/css/theme.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LC0M1Q19EK"></script>
    <link rel="stylesheet" href="../../../assets/css/custom.css">

    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-LC0M1Q19EK');
    </script>

</head>
<body class="docs-page">
<header class="header fixed-top">
    <div class="branding docs-branding">
        <div class="container-fluid position-relative py-2">
            <div class="docs-logo-wrapper">
                <!--<button id="docs-sidebar-toggler" class="docs-sidebar-toggler docs-sidebar-visible me-2 d-xl-none"
                        type="button">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>-->

                <div class="site-logo">
                    <a class="navbar-brand" href="../../../index.html">
                        <img src="../../../assets/images/StackSagaIcon.png"
                             alt="logo"/>
                        <span class="logo-text">Stack<span class="text-alt">SAGA</span></span>
                    </a>
                </div>



            </div><!--//docs-logo-wrapper-->
            <div class="docs-top-utilities d-flex justify-content-end align-items-center">
                <div class="top-search-box d-none d-lg-flex">
                    <form class="search-form">
                        <input type="text" placeholder="Search the docs..." name="search"
                               class="form-control search-input">
                        <button type="submit" class="btn search-btn" value="Search"><i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>

                <ul class="social-list list-inline mx-md-3 mx-lg-5 mb-0 d-none d-lg-flex">
                    <li class="list-inline-item"><a href="https://github.com/stacksaga"><i
                            class="fab fa-github fa-fw"></i></a></li>
                    <li class="list-inline-item"><a href="https://stackoverflow.com/questions/tagged/stacksaga"><i
                            class="fab fa-stack-overflow fa-fw"></i></a></li>

                </ul><!--//social-list-->

            </div><!--//docs-top-utilities-->
        </div><!--//container-->
    </div><!--//branding-->
</header><!--//header-->
<div>

    <div>
        <div class="container">
            <article class="docs-article" id="section-1">
                <header class="docs-header">
                    <h1 id="microservice-introduction" class="docs-heading">Handler
                    </h1>
                    <section class="docs-intro">
                        <p>

                            The handler is where the transaction is initiated as well as you're notified about each and
                            every action while the process by the SEC. As an example
                            you hand over your transaction to the stack saga by mentioning the starting point. After
                            handing over, the framework will invoke your executors one by one. This process happens from
                            the base microservice. (The application that you are working on) So base microservice is
                            the responsible service to update the status of each sub process. According to the example
                            after doing the payment successfully the order status should be updated as payment
                            successful. How you can get notified about that? Handler is the place you get notified about
                            the event after executing each and every sub process. Likewise, there are many callback
                            functions are there to be notified about some events by the framework. The following table
                            will show you what they're.
                        </p>

                        <ol>
                            <li>
                                <b>onEachProcessPerformed</b>
                                <p>
                                    This method will be invoked after executing each sub process successfully.
                                    - just think about our example. After payment process success the order status
                                    should be updated as payment successful and also after successfully dispatched the
                                    order, the order status should be updated as order dispatched. And just think, you
                                    want to update your customer by sending an email after payment process and after
                                    dispatching process. Handler is the place that you can invoke your processes.

                                </p>
                            </li>
                            <li>
                                <b>onEachRevertPerformed</b>
                                <p>
                                    This is the opposite of the onEachProcess. That works after every successful
                                    process. If the whole transaction has to be reverted in some point, the compensation
                                    process start from that point. Then the revert method of each executed executors
                                    start to be executed as the compensations. If you want to get notified after each
                                    compensation onEachRevert method will be invoked by the framework with all the data
                                    that you want.
                                </p>
                                <p>
                                    According to the example, if the payment process is failed, you have to update the
                                    order status as payment failed. This kind of execution can be proceeded in this
                                    method.
                                </p>
                            </li>


                            <li>
                                <b>onTransactionCompleted</b>
                                <p>
                                    There are two meanings of transaction-complete. One is that the transaction was
                                    processed without any process exception. When considering the example the
                                    create-order success, user checking is successful, make payment is success ,
                                    increase point is success , and finally dispatching the order is also success.
                                    The 2nd success is, a process exception was happened and after that all the relevant
                                    compensation has been processed successfully. (That means a revert error hasn't been
                                    occurred while the compensation process) otherwise we can say the compensation has
                                    been processed smoothly without any exceptions.
                                </p>
                            </li>


                            <li>
                                <b>onProcessException</b>
                                <p>
                                    This is not relevant to the sub process. That means the process exception can be
                                    happened only one time in entire process. When considering the example, you are
                                    going to dispatch the order, and it is failed because of non retryable exception.
                                    (Just think the order is not existing in the database) then the compensation
                                    process will be started. This is the turning point to compensation start. On that
                                    time this method will invoke by the framework with the data that you want.
                                </p>
                            </li>

                            <li>
                                <b>onTransactionTerminated</b>
                                <p>
                                    According to the flow any revert process can't have non retryable exception. That is
                                    the rule. But sometimes the programmer may haven't been handled that. Then the
                                    revert process also can't be processed anymore. Then the framework mark that
                                    transaction as a garbage transaction and terminate the process. This is very rare
                                    case. But it can be happened.
                                </p>
                            </li>

                        </ol>

                        <div>
                            <a target="_blank"
                               href="../../../assets/img/1.0/topics/stack-saga-e-store-example-handler.drawio.svg"><img
                                    class="img-fluid"
                                    src="../../../assets/img/1.0/topics/stack-saga-e-store-example-handler.drawio.svg"
                                    alt="Handler in StackSaga"
                                    title="Handler"/>
                            </a>
                        </div>
                        <br>
                        <br>
                        <h3>Implementation of a Handler</h3>
                        <p>here you can see a handler Implementation. the handler is for the transaction place-order.
                            that's why the handler called as <code>PlaceOrderHandler</code>. and the handler class
                            annotate as <code>@Handler</code> and the class has been implemented by
                            <code>ExecutionListener</code> with providing the relevant aggregator called <code>PlaceOrderAggregator</code>.
                            according to the ExecutionListener interface your custom handler have all the methods that
                            we have disused above.
                        </p>
                        <script src="https://gist.github.com/mafei-dev/e377060f8ce71161a0b8b9a53ac9b1f9.js"></script>
                    </section>

                    <section class="docs-section" id="item-1-4">
                        <h4>Explore the concepts behind stackSaga</h4>
                        <ul>
                            <li><a href="./../introduction.html">Introduction</a></li>
                            <li><a href="./../architecture.html">High-level Architecture</a></li>
                            <li><a href="./../how-works-stack-saga-transaction-types.html">How Stack Saga Execution Types
                                work</a>
                            </li>
                            <li><a href="../topics/SEC.html">Saga execution coordinator (SEC)</a></li>
                            <li><a href="../topics/SEC.html#dual-consistency-problem-of-sec">Dual-consistency problem of
                                SEC</a></li>

                            <li><a href="../topics/circuit-breaker.html">Real-time Circuit Breaker</a></li>
                            <li><a href="../topics/SEC.html#event-store">Event-Store</a></li>

                            <li><a target="_blank" href="../topics/aggregator.html">Aggregator</a></li>
                            <li><a target="_blank" href="../topics/executor.html">Executor</a></li>
                            <li><a target="_blank" href="../topics/handler.html">Handlers</a></li>
                            <li><a target="_blank" href="../topics/retryable-exception-vs-non-retryable-exception.html">Retryable
                                Exceptions</a></li>
                            <li><a href="../topics/hint-store.html">Hint store</a></li>
                            <li><a href="../topics/stacksaga-admin-dashboard.html">StackSaga Admin</a></li>
                        </ul>

                    </section>

                </header>

            </article>

        </div>
    </div>
</div>
<!-- Javascript -->
<script src="../../../assets/plugins/popper.min.js"></script>
<script src="../../../assets/plugins/bootstrap/js/bootstrap.min.js"></script>


<!-- Page Specific JS -->
<script src="../../../assets/plugins/smoothscroll.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
<script src="../../../assets/js/highlight-custom.js"></script>
<script src="../../../assets/plugins/simplelightbox/simple-lightbox.min.js"></script>
<script src="../../../assets/plugins/gumshoe/gumshoe.polyfills.min.js"></script>
<script src="../../../assets/js/docs.js"></script>
</body>
</html> 

